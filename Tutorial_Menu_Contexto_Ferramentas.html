<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tutorial — Adicionar atalhos ao menu de contexto (fundo da pasta)</title>
  <style>
    :root{
      --bg:#0f172a;
      --panel:#111827;
      --card:#0b1220;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --acc:#60a5fa;
      --green:#22c55e;
      --red:#ef4444;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 600px at 80% -10%, #0b1220 0, transparent 40%),
                      radial-gradient(800px 500px at -10% 10%, #0b1220 0, transparent 40%),
                      var(--bg);
      color:var(--text); font-family:var(--sans); line-height:1.6;
    }
    header{padding:32px 20px 16px; text-align:center}
    h1{margin:0 0 6px; font-size:clamp(22px, 3vw, 36px); letter-spacing:0.2px; color:var(--acc);}
    .subtitle{color:var(--acc); font-size:clamp(13px, 2vw, 16px)}
    main{max-width:900px; margin:0 auto; padding:32px 40px; background:var(--panel); border-radius:8px; box-shadow:0 2px 12px #0001;}
    .card{
      background:var(--card);
      border:1px solid var(--panel);
      border-radius:12px; padding:20px; margin:14px 0;
      box-shadow: 0 2px 8px #1976d211;
    }
    h2{margin:8px 0 6px; font-size:22px; color:var(--acc);}
    h3{margin:14px 0 6px; font-size:18px; color:var(--acc);}
    p{margin:10px 0}
    ol, ul{margin-bottom:1.5em; margin-left:2em;}
    code, pre{font-family:var(--mono); font-size:13.5px; background:var(--card); color:var(--text);}
    pre{
      border:1px solid var(--panel);
      padding:12px; border-radius:8px; overflow:auto; margin-left:1.5em;
    }
    kbd{font-family:var(--mono); background:var(--card); border:1px solid var(--panel); padding:2px 6px; border-radius:6px; color:var(--acc);}
    .tip{border-left:3px solid var(--acc); padding-left:12px; color:var(--acc)}
    .warn{border-left:3px solid var(--red); padding-left:12px; color:var(--red)}
    .ok{border-left:3px solid var(--green); padding-left:12px; color:var(--green)}
    details{margin:8px 0 0}
    summary{cursor:pointer; user-select:none}
    .grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(280px,1fr)); gap:12px}
    .small{font-size:12.5px; color:var(--acc)}
    .hr{height:1px; background:linear-gradient(90deg, transparent, var(--acc), transparent); margin:18px 0}
    .muted{color:var(--muted)}
    a{color:var(--acc); text-decoration:none}
    a:hover{text-decoration:underline}
    .badge{display:inline-block; border:1px solid var(--panel); border-radius:999px; padding:2px 10px; font-size:12px; color:var(--acc)}
    .step{counter-increment: step}
    .header-container {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 1px solid rgba(96, 165, 250, 0.2);
      padding-bottom: 24px;
    }
    .logo-link {
      display: inline-block;
      text-decoration: none;
    }
    .logo {
      width: 60px;
      height: 60px;
      margin: 0 auto 16px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s;
      display: block;
    }
    .logo:hover {
      transform: scale(1.05);
    }
    .nav-button {
      display: inline-flex;
      align-items: center;
      padding: 8px 16px;
      background: var(--acc);
      color: #0f172a;
      text-decoration: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 0.9em;
      font-family: var(--sans);
      transition: all 0.2s;
      margin-top: 15px;
    }
    .nav-button:hover {
      background: #a1c9fa;
      transform: translateY(-1px);
    }
    .nav-button::before {
      content: '←';
      margin-right: 6px;
      font-size: 1.1em;
    }
    .step h3::before{
      content: counter(step) "."; margin-right:8px; color:var(--acc)
    }
    .step h3{display:flex; align-items:center}
  </style>
</head>
<body>
  <header>
    <h1>Atalhos no menu de contexto (fundo da pasta)</h1>
    <div class="subtitle">Guia prático para criar e manter comandos no clique direito — <span class="badge">HKCU\\Software\\Classes\\Directory\\Background\\shell</span></div>
  </header>

  <main>
    <div class="header-container">
      <a href="index.html" class="logo-link">
        <img src="imagens/kaiseramarelo.png" alt="Logo" class="logo">
      </a>
      <a href="index.html" class="nav-button">Voltar ao Índice</a>
    </div>
    <section class="card">
      <h2>Visão geral</h2>
      <p>Este tutorial explica como adicionar itens personalizados ao <strong>menu de contexto quando você clica com o botão direito em um espaço vazio de uma pasta</strong>. O método usa somente o Registro do Windows no caminho <code>HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\shell</code>, não requer admin e funciona por usuário.</p>
      <p class="tip"><strong>Dica rápida:</strong> Para scripts que precisam saber <em>qual pasta foi clicada</em>, use o placeholder <code>"%V"</code> como argumento.</p>
    </section>

    <section class="card">
      <h2>Modelo básico (um comando)</h2>
      <ol>
        <li class="step">
          <h3>Criar a chave do item</h3>
          <p>Abra <kbd>regedit</kbd> e navegue até <code>HKCU\\Software\\Classes\\Directory\\Background\\shell</code>. Clique com o botão direito em <em>shell</em> → <em>Novo &gt; Chave</em>. Nome sugestivo, ex.: <code>Estrutura</code>.</p>
        </li>
        <li class="step">
          <h3>Definir o texto visível</h3>
          <p>Do lado direito, dê duplo clique em <em>(Padrão)</em> e defina, por exemplo: <code>Criar Estrutura</code>.</p>
        </li>
        <li class="step">
          <h3>Apontar o comando</h3>
          <p>Crie uma subchave chamada <code>command</code> dentro da sua chave (<code>Estrutura</code>). No <em>(Padrão)</em> coloque:</p>
          <pre>wscript.exe "G:\Meu Drive\workspace\estrutura.vbs" "%V"</pre>
          <p>Isso chama o <code>wscript.exe</code> e passa o caminho da pasta atual (<code>%V</code>) ao seu script.</p>
        </li>
      </ol>
      <div class="ok"><strong>Pronto!</strong> Abra qualquer pasta, clique no fundo com o botão direito e use o comando.</div>
    </section>

    <section class="card">
      <h2>Outros tipos de comandos (exemplos prontos)</h2>
      <div class="grid">
        <div>
          <h3>.BAT / .CMD</h3>
          <pre>cmd.exe /c ""C:\Caminho\minha-acao.bat" "%V"""</pre>
          <p class="small">Observação: o par de aspas duplas após <code>/c</code> é intencional para preservar caminhos com espaços.</p>
        </div>
        <div>
          <h3>PowerShell (.ps1)</h3>
          <pre>powershell.exe -NoProfile -ExecutionPolicy Bypass -File "C:\Caminho\acao.ps1" "%V"</pre>
        </div>
        <div>
          <h3>Executável (.exe)</h3>
          <pre>"C:\Caminho\app.exe" "%V"</pre>
        </div>
        <div>
          <h3>VBS (outro local)</h3>
          <pre>wscript.exe "C:\Scripts\util.vbs" "%V"</pre>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>Melhorias úteis (opcionais)</h2>
      <h3>Ícone no menu</h3>
      <p>Na sua chave do item (ex.: <code>Estrutura</code>), crie um valor de cadeia (REG_SZ) chamado <code>Icon</code> com o caminho do ícone:</p>
      <pre>(REG_SZ) Icon = "C:\Caminho\icone.ico"</pre>
      <p class="small muted">Também funciona apontar para um .exe ou .dll com índice, ex.: <code>"C:\Windows\System32\shell32.dll,80"</code>.</p>

      <h3>Mostrar somente com Shift (menu estendido)</h3>
      <p>Crie um valor de cadeia vazio chamado <code>Extended</code>. O item só aparece ao usar <kbd>Shift</kbd> + clique direito.</p>
      <pre>(REG_SZ) Extended = ""</pre>

      <h3>Posicionar no topo ou base</h3>
      <p>Crie um valor de cadeia <code>Position</code> com <code>Top</code> ou <code>Bottom</code>:</p>
      <pre>(REG_SZ) Position = "Top"</pre>

      <h3>Separadores visuais</h3>
      <p>Algumas versões do Explorer respeitam chaves vazias para separadores. Você pode criar valores (REG_SZ) <code>SeparatorBefore</code> e/ou <code>SeparatorAfter</code>:</p>
      <pre>(REG_SZ) SeparatorBefore = ""</pre>

      <h3>Atalhos de teclado (aceleradores)</h3>
      <p>No texto do menu, prefixe uma letra com <code>&amp;</code> para sublinhá-la: <code>&amp;Criar Estrutura</code> (atalho: <kbd>C</kbd>).</p>
    </section>

    <section class="card">
      <h2>Submenu com vários comandos</h2>
      <p>Você pode criar um grupo (submenu) e, dentro dele, múltiplos itens.</p>
      <ol>
        <li class="step">
          <h3>Criar o grupo</h3>
          <p>Em <code>...\\shell</code>, crie a chave <code>Ferramentas</code>. Defina <em>(Padrão)</em> como <code>Minhas Ferramentas</code>. (Opcional) adicione <code>Icon</code>.</p>
        </li>
        <li class="step">
          <h3>Adicionar os filhos</h3>
          <p>Dentro de <code>Ferramentas</code>, crie uma subchave chamada <code>shell</code>. Cada item fica como uma chave dentro dessa <code>shell</code> interna:</p>
          <pre>
Ferramentas
 ├─ (Padrão) = "Minhas Ferramentas"
 ├─ Icon = "C:\Caminho\icone.ico"     (opcional)
 └─ shell
     ├─ Estrutura
     │   └─ command
     │       └─ (Padrão) = wscript.exe "G:\Meu Drive\workspace\estrutura.vbs" "%V"
     └─ AbrirCMD
         └─ command
             └─ (Padrão) = cmd.exe /k "cd /d "%V""
          </pre>
        </li>
      </ol>
      <p class="tip small">No exemplo acima, <em>AbrirCMD</em> mantém o prompt na pasta clicada.</p>
    </section>

    <section class="card">
      <h2>Modelos (.reg) para importar</h2>
      <p>Copie, salve como <code>.reg</code> e dê dois cliques para importar.</p>
      <h3>1) Item simples chamando VBS (seu caso)</h3>
      <pre>Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Estrutura]
@="Criar Estrutura"
"Icon"="C:\\Windows\\System32\\shell32.dll,268"  ; opcional
"Position"="Top"                                 ; opcional

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Estrutura\command]
@="wscript.exe \"G:\\Meu Drive\\workspace\\estrutura.vbs\" \"%V\""
</pre>

      <h3>2) Submenu com dois itens</h3>
      <pre>Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Ferramentas]
@="Minhas Ferramentas"
"Icon"="C:\\Windows\\System32\\imageres.dll,15"

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Ferramentas\shell]

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Ferramentas\shell\Estrutura]
@="&amp;Criar Estrutura"

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Ferramentas\shell\Estrutura\command]
@="wscript.exe \"G:\\Meu Drive\\workspace\\estrutura.vbs\" \"%V\""

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Ferramentas\shell\AbrirCMD]
@="Abrir &amp;Prompt aqui"

[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Ferramentas\shell\AbrirCMD\command]
@="cmd.exe /k \"cd /d \"%V\"\""
</pre>
      <p class="small muted">Atenção às barras invertidas duplas (<code>\\</code>) e aspas escapadas (<code>\"</code>) dentro do arquivo .reg.</p>
    </section>

    <section class="card">
      <h2>Boas práticas</h2>
      <ul>
        <li>Use caminhos absolutos e entre aspas; evite depender da pasta atual.</li>
        <li>Teste com pastas que têm espaços e acentos.</li>
        <li>Para scripts PowerShell, prefira <code>-NoProfile</code> e <code>-ExecutionPolicy Bypass</code> para reduzir interferências.</li>
        <li>Mantenha todos os scripts/atalhos em uma pasta dedicada, ex.: <code>G:\Meu Drive\workspace</code>.</li>
      </ul>
    </section>

    <section class="card">
      <h2>Remover/Desinstalar um item</h2>
      <p>Para remover, apague a chave do item (ou do submenu) que você criou. Exemplo:</p>
      <pre>HKCU\Software\Classes\Directory\Background\shell\Estrutura</pre>
      <details>
        <summary>Modelo .reg para remover</summary>
        <pre>Windows Registry Editor Version 5.00

[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Estrutura]
</pre>
      </details>
    </section>

    <section class="card">
      <h2>Resolução de problemas</h2>
      <ul>
        <li><strong>O item não aparece:</strong> confirme o caminho da chave; reinicie o Explorer (Gerenciador de Tarefas → <em>Windows Explorer</em> → Reiniciar).</li>
        <li><strong>O comando não roda:</strong> verifique as aspas e se o arquivo existe; teste o comando direto no <kbd>Win+R</kbd>.</li>
        <li><strong>Script PowerShell bloqueado:</strong> certifique-se de usar <code>-ExecutionPolicy Bypass</code> no comando.</li>
        <li><strong>Quero que apareça só com Shift:</strong> adicione o valor <code>Extended</code> vazio na chave do item.</li>
      </ul>
    </section>

    <div class="hr"></div>
    <footer class="small muted">
      Versão 1.0 — Este guia foi feito para uso interno. Modifique os caminhos conforme necessário.
    </footer>
  </main>
</body>
</html>
